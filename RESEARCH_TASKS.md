# üîç –ò–°–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ó–ê–î–ê–ß–ò

> **–ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞!**  
> –≠—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

## üí∞ PayMe API - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–≤—Ä–∞—Ç—ã (–û–ë–ù–û–í–õ–ï–ù–û)

### –ù–∞–π–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

#### ‚úÖ –ß—Ç–æ —É–¥–∞–ª–æ—Å—å –≤—ã—è—Å–Ω–∏—Ç—å:
1. **PayMe (paycom.uz)** - —É–∑–±–µ–∫—Å–∫–∞—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
2. **–°—É—â–µ—Å—Ç–≤—É–µ—Ç Python SDK** - payme-pkg —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: docs.pay-tech.uz (–Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è), –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–∫—Ä—ã—Ç–∞
4. **GitHub –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–ª–∏—á–∏–µ** `handle_cancelled_payment` –º–µ—Ç–æ–¥–æ–≤

#### üîç –ê–Ω–∞–ª–∏–∑ payme-pkg:
```python
# –í SDK –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
def handle_created_payment(self, params, result, *args, **kwargs):
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
    
def handle_successfully_payment(self, params, result, *args, **kwargs):
    # –£—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂
    
def handle_cancelled_payment(self, params, result, *args, **kwargs):
    # –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂ - –≠–¢–û –í–ê–ñ–ù–û!
```

### ‚ùó –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è:
1. **–ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ—Ç–º–µ–Ω—ã**: –ú–æ–∂–µ—Ç –ª–∏ –º–µ—Ä—á–∞–Ω—Ç –æ—Ç–º–µ–Ω–∏—Ç—å –ø–ª–∞—Ç–µ–∂ —á–µ—Ä–µ–∑ API?
2. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –í —Ç–µ—á–µ–Ω–∏–µ –∫–∞–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å?
3. **–¢–∏–ø—ã –æ—Ç–º–µ–Ω**: –ü–æ–ª–Ω–∞—è –æ—Ç–º–µ–Ω–∞ vs —á–∞—Å—Ç–∏—á–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç?
4. **–ö–æ–º–∏—Å—Å–∏–∏**: –í–∑–∏–º–∞–µ—Ç—Å—è –ª–∏ –∫–æ–º–∏—Å—Å–∏—è –∑–∞ –æ—Ç–º–µ–Ω—É?

### üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:
**–°–†–û–ß–ù–û –¢–†–ï–ë–£–ï–¢–°–Ø:**
1. **–°–≤—è–∑–∞—Ç—å—Å—è —Å PayMe support** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å sandbox** —Å –≤–∞—à–∏–º–∏ credentials
3. **–ò–∑—É—á–∏—Ç—å merchant dashboard** –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π –≤–æ–∑–≤—Ä–∞—Ç–∞

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
**–†–µ–∞–ª–∏–∑—É–µ–º –ì–ò–ë–†–ò–î–ù–´–ô –ø–æ–¥—Ö–æ–¥:**

```php
// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
class RefundService 
{
    public function requestRefund($ticket_id, $reason, $amount = null)
    {
        $ticket = Ticket::find($ticket_id);
        
        // –ü—ã—Ç–∞–µ–º—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç —á–µ—Ä–µ–∑ PayMe
        try {
            $result = PayMe::refund($ticket->payment_id, $amount ?? $ticket->final_price);
            
            if ($result->success) {
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç —É—Å–ø–µ—à–µ–Ω
                $ticket->update(['status' => 'refunded']);
                return ['type' => 'automatic', 'result' => $result];
            }
        } catch (PayMeApiException $e) {
            // API –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –∏–ª–∏ –æ—à–∏–±–∫–∞
            Log::warning("PayMe refund failed: " . $e->getMessage());
        }
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞—è–≤–∫—É –Ω–∞ —Ä—É—á–Ω–æ–π –≤–æ–∑–≤—Ä–∞—Ç
        $request = RefundRequest::create([
            'ticket_id' => $ticket_id,
            'reason' => $reason,
            'amount' => $amount ?? $ticket->final_price,
            'status' => 'pending',
            'account_info' => $this->getRefundAccountInfo($ticket)
        ]);
        
        // –£–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ Telegram
        TelegramService::sendRefundRequest($request);
        
        return ['type' => 'manual', 'request_id' => $request->id];
    }
}
```

---

## üîî Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –í—ã–±–æ—Ä —Ä–µ—à–µ–Ω–∏—è (–§–ò–ù–ê–õ–ò–ó–ò–†–û–í–ê–ù)

### ‚úÖ **–†–ï–®–ï–ù–ò–ï –ü–†–ò–ù–Ø–¢–û: OneSignal**

#### –ü–æ—á–µ–º—É OneSignal:
1. **–ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - MVP –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤
2. **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω** –¥–æ 30,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 
3. **–ì–æ—Ç–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –∫–ª–∏–∫–∏, –æ—Ç–∫—Ä—ã—Ç–∏—è, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
4. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤** - Chrome, Firefox, Safari, Edge
5. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏–∑ –∫–æ—Ä–æ–±–∫–∏

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```php
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞
composer require ladumor/one-signal

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env
ONESIGNAL_APP_ID=your-app-id
ONESIGNAL_REST_API_KEY=your-api-key

// –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
OneSignal::sendNotificationToUser([
    'contents' => [
        'ru' => '–í–∞—à –±–∏–ª–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!',
        'uz' => 'Sizning chiptangiz tasdiqlandi!',
        'en' => 'Your ticket is confirmed!'
    ],
    'headings' => [
        'ru' => '–ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–∞',
        'uz' => 'Chipta sotib olish', 
        'en' => 'Ticket Purchase'
    ],
    'include_external_user_ids' => [$user_id],
    'data' => [
        'ticket_id' => $ticket_id,
        'event_id' => $event_id,
        'type' => 'ticket_purchased'
    ],
    'url' => "https://sellercom.uz/tickets/{$ticket_id}"
]);
```

#### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
- **–ö–æ–≥–¥–∞**: –ü—Ä–∏ —Ä–æ—Å—Ç–µ –¥–æ 25,000+ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ó–∞—á–µ–º**: –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è, —ç–∫–æ–Ω–æ–º–∏—è

---

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - –°–æ–±—ã—Ç–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏ (–û–ë–ù–û–í–õ–ï–ù–û)

### ‚úÖ **–§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –°–û–ë–´–¢–ò–ô:**

#### üé´ –í–æ—Ä–æ–Ω–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤:
```php
// 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
Analytics::track('event_viewed', [
    'event_id' => $event_id,
    'source' => 'direct|search|social|email',
    'utm_campaign' => $utm_campaign
]);

// 2. –ù–∞—á–∞–ª–æ –≤—ã–±–æ—Ä–∞ –±–∏–ª–µ—Ç–∞
Analytics::track('ticket_selection_started', [
    'event_id' => $event_id,
    'ticket_types_available' => $types_count
]);

// 3. –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞
Analytics::track('ticket_type_selected', [
    'event_id' => $event_id,
    'ticket_type_id' => $ticket_type_id,
    'price' => $price
]);

// 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
Analytics::track('promocode_applied', [
    'event_id' => $event_id,
    'promocode' => $code,
    'discount_amount' => $discount
]);

// 5. –ù–∞—á–∞–ª–æ –æ–ø–ª–∞—Ç—ã
Analytics::track('payment_started', [
    'event_id' => $event_id,
    'amount' => $total_amount,
    'payment_method' => 'payme'
]);

// 6. –£—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞
Analytics::track('ticket_purchased', [
    'event_id' => $event_id,
    'ticket_id' => $ticket_id,
    'revenue' => $final_amount,
    'currency' => 'UZS'
]);
```

#### üìà –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:
```php
// –ö–ª–∏–∫–∏ –ø–æ –±–∞–Ω–Ω–µ—Ä–∞–º
Analytics::track('banner_clicked', [
    'banner_id' => $banner_id,
    'position' => 'header|sidebar|content',
    'campaign' => $campaign_name
]);

// –ü–µ—Ä–µ—Ö–æ–¥—ã –∫ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
Analytics::track('partner_clicked', [
    'partner_id' => $partner_id,
    'source_page' => $current_page,
    'partner_name' => $partner_name
]);

// –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –±–ª–æ–≥–µ
Analytics::track('blog_read', [
    'article_id' => $article_id,
    'reading_time' => $seconds_spent,
    'scroll_depth' => $percentage
]);
```

#### üìä –î–∞—à–±–æ—Ä–¥ –º–µ—Ç—Ä–∏–∫–∏:
1. **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤–æ—Ä–æ–Ω–∫–∏**: –ø—Ä–æ—Å–º–æ—Ç—Ä ‚Üí –≤—ã–±–æ—Ä ‚Üí –ø–æ–∫—É–ø–∫–∞
2. **AOV (—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫)**: –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º –∏ —Ç–∏–ø–∞–º –±–∏–ª–µ—Ç–æ–≤  
3. **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞**: –æ—Ä–≥–∞–Ω–∏–∫–∞, —Ä–µ–∫–ª–∞–º–∞, —Å–æ—Ü—Å–µ—Ç–∏
4. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –∫–æ–Ω–≤–µ—Ä—Å–∏—è
5. **ROI –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤**: –∫–ª–∏–∫–∏ ‚Üí –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
6. **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏**: –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ, bounce rate

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ï):

### üö® –ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–Ω–æ (–Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ):
1. **[–°–†–û–ß–ù–û] PayMe API –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ**
   - –°–≤—è–∑–∞—Ç—å—Å—è —Å PayMe support
   - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ credentials 
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞

2. **[–í –†–ê–ë–û–¢–ï] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OneSignal**
   - –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç OneSignal
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Laravel
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

3. **[–ì–û–¢–û–í–û] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**
   - –°–æ–±—ã—Ç–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã ‚úÖ
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞ ‚úÖ
   - –ù—É–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### üìã –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
- [ ] **PayMe –≤–æ–∑–≤—Ä–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã** (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- [x] **Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å –≤—ã–±—Ä–∞–Ω** (OneSignal)
- [x] **–°–æ–±—ã—Ç–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã** (—Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã)
- [x] **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ QR-–∫–æ–¥–æ–≤ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–∞** (ID+Hash+–æ—Ñ–ª–∞–π–Ω)
- [x] **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞** (JSON –ø–æ–ª—è)
- [x] **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞** (–º—É–ª—å—Ç–∏–∫–∞–Ω–∞–ª—å–Ω–∞—è)

### ‚è∞ –î–µ–¥–ª–∞–π–Ω: 
**PayMe API –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–æ –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞—Ç–µ–∂–µ–π!**

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
- [PayMe SDK (Python)](https://github.com/Muhammadali-Akbarov/payme-pkg)
- [OneSignal Laravel](https://github.com/ladumor/one-signal)
- [PayMe Support](https://help.paycom.uz/) (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

**–°—Ç–∞—Ç—É—Å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π: 80% –∑–∞–≤–µ—Ä—à–µ–Ω–æ** 